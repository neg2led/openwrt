// SPDX-License-Identifier: (GPL-2.0+ OR MIT)

/dts-v1/;
#include "fsl-ls1043a.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>

/ {
	aliases {
		crypto = &crypto;
		serial0 = &duart0;
		serial1 = &duart1;
		serial2 = &duart2;
		serial3 = &duart3;
		ethernet0 = &enet2;
		ethernet1 = &enet0;
		ethernet2 = &enet1;
		ethernet3 = &enet4;
		ethernet4 = &enet5;
	};

	chosen {
		stdout-path = "serial0:115200n8";
	};

	leds {
		compatible = "gpio-leds";
		status = "disabled";
	};

	keys {
		compatible = "gpio-keys-polled";
		#address-cells = <1>;
		#size-cells = <0>;
		poll-interval = <1000>;
		status = "disabled";
	};

};

&esdhc {
	#address-cells = <1>;
	#size-cells = <0>;
	mmc-ddr-1_8v;
	mmc-hs200-1_8v;
	mmc-hs400-1_8v;
	non-removable;
	no-sd;
	no-sdio;

	emmc0: mmccard@0 {
		reg = <0>;
		compatible = "mmc-card";
	};
};

&i2c0 {
	status = "okay";
	scl-gpios = <&gpio4 12 GPIO_ACTIVE_HIGH>;

	tpm@29 {
		reg = <0x29>;
		label = "tpm";
		compatible = "atmel,at97sc3204t";
	};

	rtc0: rtc@30 {
		reg = <0x30>;
		compatible = "sii,s35390a";
	};

	eeprom: eeprom@50 {
		reg = <0x50>;
		compatible = "atmel,24c02";
		pagesize = <1>;
	};
};

&qspi {
	status = "okay";
	bus-num = <0>;

	flash0: flash@0 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "fsl,mx25u3235f", "jedec,spi-nor";
		reg = <0>;
		spi-max-frequency = <50000000>;
		spi-rx-bus-width = <4>;
		spi-tx-bus-width = <4>;
		m25p,fast-read;
		mode = <0>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			partition@0 {
				reg = <0x00 0x100000>;
				label = "rcw+pbi";
				read-only;
			};

			partition@100000 {
				reg = <0x100000 0x100000>;
				label = "u-boot";
				read-only;
			};

			partition@200000 {
				reg = <0x200000 0x10000>;
				label = "u-boot-env";
			};

			partition@210000 {
				reg = <0x210000 0x10000>;
				label = "empty-1";
				read-only;
			};

			partition@220000 {
				reg = <0x220000 0x20000>;
				label = "fman-ucode";
				read-only;
			};

			partition@240000 {
				reg = <0x240000 0x40000>;
				label = "empty-2-ppa";
				read-only;
			};

			partition@280000 {
				reg = <0x280000 0x20000>;
				label = "wg-cfg0";
				read-only;
			};

			partition@2a0000 {
				reg = <0x2a0000 0x20000>;
				label = "wg-cfg1";
				read-only;
			};

			partition@2c0000 {
				reg = <0x2c0000 0x20000>;
				label = "wg-mfg";
				read-only;
			};

			partition@2e0000 {
				reg = <0x2e0000 0x20000>;
				label = "empty-3";
				read-only;
			};

			partition@300000 {
				reg = <0x300000 0x20000>;
				label = "fman-ucode-old";
				read-only;
			};

			partition@320000 {
				reg = <0x320000 0xe0000>;
				label = "wg-bootopt";
				read-only;
			};
		};
	};
};

&dspi0 {
	status = "okay";
	bus-num = <0>;
};

&duart0 {
	status = "okay";
};

&duart1 {
	status = "okay";
};

&pcie1 {
	status = "okay";
};

&pcie2 {
	status = "okay";
};

&pcie3 {
	status = "okay";
};

&usb0 {
	status = "okay";
};

&usb1 {
	status = "okay";
};

&usb2 {
	status = "okay";
};

&tmu {
	/* Non-standard TMU calibration, from OEM devicetree */
	fsl,tmu-calibration = <0x00000000 0x00000023
			       0x00000001 0x0000002a
			       0x00000002 0x00000031
			       0x00000003 0x00000037
			       0x00000004 0x0000003e
			       0x00000005 0x00000044
			       0x00000006 0x0000004b
			       0x00000007 0x00000051
			       0x00000008 0x00000058
			       0x00000009 0x0000005e
			       0x0000000a 0x00000065
			       0x0000000b 0x0000006b

			       0x00010000 0x00000023
			       0x00010001 0x0000002b
			       0x00010002 0x00000033
			       0x00010003 0x0000003b
			       0x00010004 0x00000043
			       0x00010005 0x0000004b
			       0x00010006 0x00000054
			       0x00010007 0x0000005c
			       0x00010008 0x00000064
			       0x00010009 0x0000006c

			       0x00020000 0x00000021
			       0x00020001 0x0000002c
			       0x00020002 0x00000036
			       0x00020003 0x00000040
			       0x00020004 0x0000004b
			       0x00020005 0x00000055
			       0x00020006 0x0000005f
			       0x00030000 0x00000013
			       0x00030001 0x0000001d
			       0x00030002 0x00000028
			       0x00030003 0x00000032>;
};

/* Add ethernet/FMAN nodes */
#include "fsl-ls1043-post.dtsi"

&enet0 {
	phy-handle = <&phy_port1>;
	phy-mode = "sgmii";
};

&enet1 {
	phy-handle = <&phy_port2>;
	phy-mode = "sgmii";
};

&enet2 {
	phy-handle = <&phy_port0>;
	phy-connection-type = "rgmii-id";
};

&enet3 {
	status = "disabled"; // Not used on this platform
};

&enet4 {
	phy-handle = <&phy_port3>;
	phy-mode = "sgmii";
};

&enet5 {
	phy-handle = <&phy_port4>;
	phy-mode = "sgmii";
};

&enet6 {
	status = "disabled"; // Not used on this platform
};

&mdio0 {
	/* Marvell Alaska 88E1543 quad-port SGMII PHY */
	phy_port1: ethernet-phy@4 {
		compatible = "ethernet-phy-ieee802.3-c45";
		reg = <4>;
	};

	phy_port2: ethernet-phy@5 {
		compatible = "ethernet-phy-ieee802.3-c45";
		reg = <5>;
	};

	phy_port3: ethernet-phy@6 {
		compatible = "ethernet-phy-ieee802.3-c45";
		reg = <6>;
	};

	phy_port4: ethernet-phy@7 {
		compatible ="ethernet-phy-ieee802.3-c45";
		reg = <7>;
	};
};

&xmdio0 {
	/* Qualcomm Atheros AR8035 */
	phy_port0: ethernet-phy@1 {
		compatible = "ethernet-phy-ieee802.3-c22";
		reg = <1>;
	};
};
